# Surf Records Module

---

## Основные возможности

- **Фильтрация по стилю Normal** - показывает только рекорды со стилем Normal (Style = 0, Mode = '')
- **Статистика** - общее количество рекордов, игроков и карт
- **Фильтрация карт** - разделение по категориям (surf, kz, bhop, other)
- **Таблица лидеров** - топ игроков по времени прохождения
- **Профили игроков** - ссылки на профили и Steam
- **Поиск** - быстрый поиск карт
- **AJAX обновления** - смена карт без перезагрузки страницы

---

## Требования

- **PHP 7.4+**
- **MySQL 5.7+**
- [NEO 3.0](https://stellarteam.store/resource/template-neo-v3)

---

## База данных

### Подключение
Настройки базы данных загружаются из `storage/cache/sessions/db.php`:
Добавлять через Админ Панель (Без префикса таблицы)

**Примечание:** Если в конфигурации `db.php` указан префикс таблиц в поле `Prefix[0]['table']`, то модуль будет использовать таблицу с этим префиксом (например, `prefix_PlayerRecords`).

---

## Установка

1. **Скопируйте модуль** в `/app/modules/`
2. **Убедитесь, что в `storage/cache/sessions/db.php`** есть конфигурация для сервера 'surf'
3. **Откройте страницу**: `https://your-domain.com/surf/`

---

## Настройки

### Отображение и кеширование
Настройки отображения и кеширования находятся в `settings.php`:

```php
return [
    // Настройки отображения
    'display' => [
        'default_map' => 'surf_whiteout',     // Карта по умолчанию
        'records_per_page' => 50,              // Лимит записей (оптимизировано)
        'map_division' => true,                // Разделение по категориям
        'default_tab' => 'surf'                // Вкладка по умолчанию
    ],
    
    // Настройки кеширования
    'cache' => [
        'enabled' => true,
        'time' => 1800,              // Общий кеш: 30 минут
        'maps_cache_time' => 3600,   // Карты: 1 час
        'stats_cache_time' => 900,   // Статистика: 15 минут
        'records_cache_time' => 600   // Рекорды: 10 минут
    ]
];
```

---

## Фильтрация по стилю Normal

Модуль показывает только рекорды со стилем **Normal**:
- `Style = 0` и `Mode = ''` (пустой)
- Исключает рекорды с другими стилями (например, Style = 10)
- Исключает рекорды с режимом "Standard"

## Рекомендации по настройке

### Для высоконагруженных сайтов
```php
'cache' => [
    'maps_cache_time' => 7200,   // 2 часа
    'stats_cache_time' => 1800,  // 30 минут
    'records_cache_time' => 1200 // 20 минут
]
```

### Для сайтов с частыми обновлениями
```php
'cache' => [
    'maps_cache_time' => 1800,   // 30 минут
    'stats_cache_time' => 600,   // 10 минут
    'records_cache_time' => 300   // 5 минут
]
```

## Решение проблем

### Переводы не появляются
Очистите кеш в Админ панели

### Рекорды не загружаются
1. Проверьте настройки базы данных в `storage/cache/sessions/db.php`
2. Убедитесь, что таблица `PlayerRecords` (или с префиксом) существует
3. Проверьте логи ошибок PHP
4. Убедитесь, что конфигурация 'surf' существует в db.php

### Медленная загрузка
1. Увеличьте время кеширования в настройках
2. Проверьте индексы базы данных

## Поддержка
При возникновении проблем:
1. Проверьте логи ошибок PHP
2. Убедитесь в правильности настроек базы данных
3. Проверьте права доступа к файлам кеша (777)
